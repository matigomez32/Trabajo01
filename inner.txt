-- Ejercicios sobre consultas relacionadas base negocio
use negocio;

-- 1) Listar a cantidad de clientes que hicieron aguna comproa en el segundo semestre de 2017
select count(idcliente) 'cantidad de clientes'
from	facturas
where 	year(fecha) = 2017 and month (fecha) > 6;

-- 2) Informar la cantidad de compras por cliente. el nombre y apellido en una única columna de 
-- dichos clientes. Ordenar por cantidad de compras en forma descendente.
select 		concat(nombre,'',apellido) as cliente,
			count(f.idcliente) compras
from   		clientes c
inner join	facturas f on c.idcliente = f.idcliente
group by	cliente
order by	compras desc;

-- 3) Informar las ventas por artículo. Cuál es el artículo más comprado?
-- Ordenar por cantidad de ventas del más vendido al menos vendido.
select 		p.articulo,
			count(f.idproducto) ventas
from		productos p
inner join	facturas f on f.idproducto = p.idproducto
group by	p.articulo
order by	ventas desc;

-- 4) Ídem ejercicio anterior pero incluir solo los artículos con una cantidad de ventas mayor o igual a 2. 
-- No incluir a los clientes que compraron camisas.
select 		p.articulo,
			count(f.idproducto) cantidad
from		productos p
inner join	facturas f
on			p.idproducto = f.idproducto
where 		p.articulo not like '%camisa%'
group by	p.articulo
having		cantidad > = 2
order by 	cantidad desc;

-- 5) Listar nombre y apellido (en una sola columna) y teléfono de los clientes que compraron pantalones. 
-- Indicar cuanto pagaron y cuando compraron. Ordenar por fecha de compra, mostrando primero la compra 
-- más antigua.
select		concat(c.nombre,'',c.apellido) cliente,
			c.telefono,
			p.precio,
			p.articulo,
			f.fecha
from		clientes c
inner join	facturas f on f.idcliente = c.idcliente
inner join	productos p on f.idproductos = p.idproductos
where		p.articulo like '%pantalon%'